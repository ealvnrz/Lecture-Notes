Estos dígitos corresponden a imágenes de 28x28 pixeles, por lo que pueden ser representados en un vector $x$ que contiene 784 números reales.
unlink('D:/Google Drive (ealvaradonarvaez@gmail.com)/Teaching/topics/Machine_learning/courses/IECD411_2022_01/Syllabus/IECD411_syllabus_cache', recursive = TRUE)
install.packages("ISLR")
library(ISLR)
library(MASS, lib.loc = "C:/Program Files/R/R-4.0.3/library")
Advertising
Advertising <- read.csv("C:/Users/ealva/Mi unidad/Teaching/topics/Machine_learning/beamer/db/Advertising.csv")
View(Advertising)
setwd("C:/Users/ealva/Mi unidad/Teaching/topics/Machine_learning/beamer")
knitr::opts_chunk$set(cache=TRUE)
knitr::opts_chunk$set(fig.path='figs/')
knitr::opts_chunk$set(cache.path='cache/')
knitr::opts_chunk$set(
fig.process = function(x) {
x2 = sub('-\\d+([.][a-z]+)$', '\\1', x)
if (file.rename(x, x2)) x2 else x
}
)
library(tidyverse)
library(MASS)
library(ISLR)
Advertising <- read.csv("./db/Advertising.csv")
library(MASS)
library(ISLR)
Advertising <- read.csv("./db/Advertising.csv")
head(Advertising)
plot(Advertising$Sales,Advertising$TV)
ggplot(Advertising$Sales,Advertising$TV)
ggplot(Advertising,aes=c(Sales,TV))
ggplot(Advertising,aes=c(x=Sales,y=TV))
View(Advertising)
ggplot(Advertising,aes=c(x=Sales,y=TV))
plot<-ggplot(Advertising,aes=c(x=Sales,y=TV))
plot
plot<-ggplot(Advertising,aes=c(x=Sales,y=TV))
plot
p1 <- ggplot(data = Advertising, mapping = aes(x = TV, y = sales)) +
p1
library(ggplot2)
Advertising <- read.csv("./db/Advertising.csv")
head(Advertising)
p1 <- ggplot(data = Advertising, mapping = aes(x = TV, y = sales)) +
p1
p1 <- ggplot(data = Advertising, mapping = aes(x = TV, y = sales)) +
p1
p1 <- ggplot(data = Advertising, mapping = aes(x = TV, y = sales))
p1
p1 <- ggplot(data = Advertising, mapping = aes(x = TV, y = Sales))
p1
p1 <- ggplot(data = Advertising,aes(x = TV, y = Sales))
p1
install.packages("gridExtra")
library(ggplot2)
library(gridExtra)
Advertising <- read.csv("./db/Advertising.csv")
head(Advertising)
p1 <- ggplot(data = Advertising, mapping = aes(x = TV, y = sales)) +
geom_point() + geom_smooth(method = "lm", se = FALSE)
p2 <- ggplot(data = Advertising, mapping = aes(x = radio, y = sales)) +
geom_point() + geom_smooth(method = "lm", se = FALSE)
p3 <- ggplot(data = Advertising, mapping = aes(x = newspaper, y = sales)) +
geom_point() + geom_smooth(method = "lm", se = FALSE)
grid.arrange(p1, p2, p3, nrow = 1)
p1 <- ggplot(data = Advertising, mapping = aes(x = TV, y = Sales)) +
geom_point() + geom_smooth(method = "lm", se = FALSE)
p2 <- ggplot(data = Advertising, mapping = aes(x = radio, y = Sales)) +
geom_point() + geom_smooth(method = "lm", se = FALSE)
p3 <- ggplot(data = Advertising, mapping = aes(x = newspaper, y = Sales)) +
geom_point() + geom_smooth(method = "lm", se = FALSE)
grid.arrange(p1, p2, p3, nrow = 1)
View(Advertising)
p1 <- ggplot(data = Advertising, mapping = aes(x = TV, y = Sales)) +
geom_point() + geom_smooth(method = "lm", se = FALSE)
p2 <- ggplot(data = Advertising, mapping = aes(x = Radio, y = Sales)) +
geom_point() + geom_smooth(method = "lm", se = FALSE)
p3 <- ggplot(data = Advertising, mapping = aes(x = Newspaper, y = Sales)) +
geom_point() + geom_smooth(method = "lm", se = FALSE)
grid.arrange(p1, p2, p3, nrow = 1)
grid.arrange(p1, p2, p3, nrow = 1)
library(ISLR)
a<-default
data(default)
summary(Default)
a<-Default
head(a)
library(ISLR)
a<-Default
head(a)
plot(a$balance,a$income)
esquisse:::esquisser()
knitr::opts_chunk$set(cache=TRUE)
knitr::opts_chunk$set(fig.path='figs/')
knitr::opts_chunk$set(cache.path='cache/')
knitr::opts_chunk$set(
fig.process = function(x) {
x2 = sub('-\\d+([.][a-z]+)$', '\\1', x)
if (file.rename(x, x2)) x2 else x
}
)
library(tidyverse)
data<-Default
ggplot(data) +
aes(x = balance, y = income, colour = default) +
geom_point(shape = "bullet", size = 1.5) +
scale_color_hue(direction = -1) +
theme_gray()
data<-Default
ggplot(data) +
aes(x = balance, y = income, colour = default) +
geom_point(shape = "bullet", size = 1.5) +
scale_color_hue(direction = -1) +
theme_gray()
esquisse:::esquisser()
esquisse:::esquisser()
ggplot(data) +
aes(x = default, y = balance, fill = default) +
geom_boxplot(shape = "circle") +
scale_fill_hue(direction = -1) +
theme_gray()
ggplot(data) +
aes(x = default, y = income, fill = default) +
geom_boxplot(shape = "circle") +
scale_fill_hue(direction = -1) +
theme_gray()
esquisse:::esquisser()
library(ISLR)
a<-Default
library(ggplot2)
ggplot(a) +
aes(x = balance, y = income, colour = default) +
geom_point(shape = "bullet", size = 1.5) +
scale_color_hue(direction = -1) +
theme_gray()
esquisse:::esquisser()
knitr::opts_chunk$set(cache=TRUE)
knitr::opts_chunk$set(fig.path='figs/')
knitr::opts_chunk$set(cache.path='cache/')
knitr::opts_chunk$set(
fig.process = function(x) {
x2 = sub('-\\d+([.][a-z]+)$', '\\1', x)
if (file.rename(x, x2)) x2 else x
}
)
library(tidyverse)
library(ISLR)
library(ggplot2)
library(gridExtra)
Advertising <- read.csv("./db/Advertising.csv")
head(Advertising)
p1<- ggplot(data = Advertising, mapping = aes(x = TV, y = Sales))+
geom_point() + geom_smooth(method = "lm", se = FALSE)
p2<- ggplot(data = Advertising, mapping = aes(x = Radio, y = Sales))+
geom_point() + geom_smooth(method = "lm", se = FALSE)
p3<- ggplot(data = Advertising, mapping = aes(x = Newspaper, y = Sales))+
geom_point() + geom_smooth(method = "lm", se = FALSE)
grid.arrange(p1, p2, p3, nrow = 1)
library(plot3D)
Income2<- read.csv("./db/Income2.csv")
# Ajuste
fit_2_3_loess <- loess(Income ~ Education + Seniority, data = Income2)
# Predicción de valores
x.pred <- seq(min(Income2$Education), max(Income2$Education), length.out = 30)
y.pred <- seq(min(Income2$Seniority), max(Income2$Seniority), length.out = 30)
xy     <- expand.grid(Education = x.pred, Seniority = y.pred)
z.pred <- matrix(predict(fit_2_3_loess, newdata = xy), nrow = 30, ncol = 30)
Income2 %>%
scatter3D(
type = "p",
x = Income2$Education,
y = Income2$Seniority,
z = Income2$Income,
colvar = NA, pch = 19, col = "gold", cex = 1.75,
phi = 25, theta = 45, expand = 0.6,
xlab = "Years of Education", ylab = "Seniority", zlab = "Income",
panel.first = scatter3D(x = Income2$Education,y = Income2$Seniority,
z = Income2$Income,colvar = NA, col = "black", add = T,
surf = list(x = x.pred, y = y.pred, z = z.pred,
fit = predict(fit_2_3_loess), facets = T, col = "skyblue",
border = "royalblue", alpha = 0.45)))
Income2 %>%
scatter3D(
type = "p",
x = Income2$Education,
y = Income2$Seniority,
z = Income2$Income,
colvar = NA, pch = 19, col = "gold", cex = 1.75,
phi = 25, theta = 45, expand = 0.6,
xlab = "Years of Education", ylab = "Seniority", zlab = "Income",
panel.first = scatter3D(x = Income2$Education,y = Income2$Seniority,
z = Income2$Income,colvar = NA, col = "black", add = T,
surf = list(x = x.pred, y = y.pred, z = z.pred,
fit = predict(fit_2_3_loess), facets = T, col = "skyblue", border = "royalblue", alpha = 0.45)))
data<-Default
head(data)
ggplot(data) +
aes(x = balance, y = income, colour = default) +
geom_point(shape = "bullet", size = 1.5) +
scale_color_hue(direction = -1) +
theme_gray()
ggplot(data) +
aes(x = balance, y = income, colour = default) +
geom_point(shape = "bullet", size = 1.5) +
scale_color_hue(direction = -1) +
theme_gray()
ggplot(data) +
aes(x = default, y = balance, fill = default) +
geom_boxplot(shape = "circle") +
scale_fill_hue(direction = -1) +
theme_gray()
ggplot(data) +
aes(x = default, y = income, fill = default) +
geom_boxplot(shape = "circle") +
scale_fill_hue(direction = -1) +
theme_gray()
logit <- glm(default ~ balance, data = data, family = "binomial")
logit <- glm(default ~ balance, data = data, family = "binomial")
logit
logit <- glm(default ~ balance, data = data, family = "binomial")
summary(logit)
logit
logit <- glm(default ~ balance, data = data, family = "binomial")
summary(logit)
glm(default ~ student, data = data, family = "binomial")
summary(logit_dummy)
logit_dummy<-glm(default ~ student, data = data, family = "binomial")
summary(logit_dummy)
summary(logit_dummy)
logit <- glm(default ~ balance + student + income, data = data,
family = "binomial")
summary(logit)
summary(logit2)
logit2 <- glm(default ~ balance + student + income, data = data,
family = "binomial")
summary(logit2)
summary(logit2)
knitr::opts_chunk$set(cache=TRUE)
knitr::opts_chunk$set(fig.path='figs/')
knitr::opts_chunk$set(cache.path='cache/')
knitr::opts_chunk$set(
fig.process = function(x) {
x2 = sub('-\\d+([.][a-z]+)$', '\\1', x)
if (file.rename(x, x2)) x2 else x
}
)
library(tidyverse)
library(ISLR)
library(ggplot2)
library(gridExtra)
Advertising <- read.csv("./db/Advertising.csv")
head(Advertising)
p1<- ggplot(data = Advertising, mapping = aes(x = TV, y = Sales))+
geom_point() + geom_smooth(method = "lm", se = FALSE)
p2<- ggplot(data = Advertising, mapping = aes(x = Radio, y = Sales))+
geom_point() + geom_smooth(method = "lm", se = FALSE)
p3<- ggplot(data = Advertising, mapping = aes(x = Newspaper, y = Sales))+
geom_point() + geom_smooth(method = "lm", se = FALSE)
grid.arrange(p1, p2, p3, nrow = 1)
library(plot3D)
Income2<- read.csv("./db/Income2.csv")
# Ajuste
fit_2_3_loess <- loess(Income ~ Education + Seniority, data = Income2)
# Predicción de valores
x.pred <- seq(min(Income2$Education), max(Income2$Education), length.out = 30)
y.pred <- seq(min(Income2$Seniority), max(Income2$Seniority), length.out = 30)
xy     <- expand.grid(Education = x.pred, Seniority = y.pred)
z.pred <- matrix(predict(fit_2_3_loess, newdata = xy), nrow = 30, ncol = 30)
Income2 %>%
scatter3D(
type = "p",
x = Income2$Education,
y = Income2$Seniority,
z = Income2$Income,
colvar = NA, pch = 19, col = "gold", cex = 1.75,
phi = 25, theta = 45, expand = 0.6,
xlab = "Years of Education", ylab = "Seniority", zlab = "Income",
panel.first = scatter3D(x = Income2$Education,y = Income2$Seniority,
z = Income2$Income,colvar = NA, col = "black", add = T,
surf = list(x = x.pred, y = y.pred, z = z.pred,
fit = predict(fit_2_3_loess), facets = T, col = "skyblue",
border = "royalblue", alpha = 0.45)))
Income2 %>%
scatter3D(
type = "p",
x = Income2$Education,
y = Income2$Seniority,
z = Income2$Income,
colvar = NA, pch = 19, col = "gold", cex = 1.75,
phi = 25, theta = 45, expand = 0.6,
xlab = "Years of Education", ylab = "Seniority", zlab = "Income",
panel.first = scatter3D(x = Income2$Education,y = Income2$Seniority,
z = Income2$Income,colvar = NA, col = "black", add = T,
surf = list(x = x.pred, y = y.pred, z = z.pred,
fit = predict(fit_2_3_loess), facets = T, col = "skyblue", border = "royalblue", alpha = 0.45)))
data<-Default
head(data)
ggplot(data) +
aes(x = balance, y = income, colour = default) +
geom_point(shape = "bullet", size = 1.5) +
scale_color_hue(direction = -1) +
theme_gray()
ggplot(data) +
aes(x = balance, y = income, colour = default) +
geom_point(shape = "bullet", size = 1.5) +
scale_color_hue(direction = -1) +
theme_gray()
ggplot(data) +
aes(x = default, y = balance, fill = default) +
geom_boxplot(shape = "circle") +
scale_fill_hue(direction = -1) +
theme_gray()
ggplot(data) +
aes(x = default, y = income, fill = default) +
geom_boxplot(shape = "circle") +
scale_fill_hue(direction = -1) +
theme_gray()
logit <- glm(default ~ balance, data = data, family = "binomial")
summary(logit)
summary(logit)
logit_dummy<-glm(default ~ student, data = data, family = "binomial")
summary(logit_dummy)
summary(logit_dummy)
logit2 <- glm(default ~ balance + student + income, data = data,
family = "binomial")
summary(logit2)
summary(logit2)
ggPredict()
install.packages("ggeffects")
library(ggeffects)
ggPredict(logit,se=TRUE,interactive=TRUE)
ggpredict(logit,se=TRUE,interactive=TRUE)
detach("package:ggeffects", unload = TRUE)
install.packages("devtools")
devtools::install_github("cardiomoon/ggiraphExtra")
library(ggiraphExtra)
ggpredict(logit,se=TRUE,interactive=TRUE)
ggPredict(logit,se=TRUE,interactive=TRUE)
ggPredict(logit2,se=TRUE,interactive=TRUE)
detach("package:ggiraphExtra", unload = TRUE)
predict(logit)
library(ggiraphExtra)
ggPredict(predict(logit2),se=TRUE,interactive=TRUE)
# Load the data
data("iris")
# Split the data into training (80%) and test set (20%)
set.seed(123)
training.samples <- iris$Species %>%
createDataPartition(p = 0.8, list = FALSE)
train.data <- iris[training.samples, ]
test.data <- iris[-training.samples, ]
# Estimate preprocessing parameters
preproc.param <- train.data %>%
preProcess(method = c("center", "scale"))
# Transform the data using the estimated parameters
train.transformed <- preproc.param %>% predict(train.data)
test.transformed <- preproc.param %>% predict(test.data)
# Load the data
data("iris")
# Split the data into training (80%) and test set (20%)
set.seed(123)
training.samples <- iris$Species %>%
createDataPartition(p = 0.8, list = FALSE)
library(tidyverse)
library(caret)
theme_set(theme_classic())
# Load the data
data("iris")
# Split the data into training (80%) and test set (20%)
set.seed(123)
training.samples <- iris$Species %>%
createDataPartition(p = 0.8, list = FALSE)
train.data <- iris[training.samples, ]
test.data <- iris[-training.samples, ]
# Estimate preprocessing parameters
preproc.param <- train.data %>%
preProcess(method = c("center", "scale"))
# Transform the data using the estimated parameters
train.transformed <- preproc.param %>% predict(train.data)
test.transformed <- preproc.param %>% predict(test.data)
library(MASS)
# Fit the model
model <- lda(Species~., data = train.transformed)
model
plot(model)
require(MASS)
require(ggplot2)
data(iris)
irisLda <- lda(iris[,-5],iris[,5])
irisProjection$row_num = 1:nrow(irisProjection)
p <- ggplot(data=irisProjection, aes(x=LD1,y=LD2,col=Species)) +
geom_point() + geom_text(aes(label = row_num))
print(p)
require(MASS)
require(ggplot2)
data(iris)
irisLda <- lda(iris[,-5],iris[,5])
irisProjection$row_num = 1:nrow(irisProjection)
require(MASS)
require(ggplot2)
data(iris)
irisLda <- lda(iris[,-5],iris[,5])
irisProjection <- cbind(scale(as.matrix(iris[,-5]),scale=FALSE) %*% irisLda$scaling,iris[,5,drop=FALSE])
irisProjection$row_num = 1:nrow(irisProjection)
p <- ggplot(data=irisProjection, aes(x=LD1,y=LD2,col=Species)) +
geom_point() + geom_text(aes(label = row_num))
print(p)
irisLda
names(irisLda)
irisLda$prior
irisLda$means
irisLda$scaling
irisLda$N
lda(data$balance,data$income)
lda(data$default,data$balance)
ggplot(data.frame(x = c(-4, 4)), aes(x)) +
stat_function(fun = dnorm, args = list(mean = -1.25, sd = 1),
color = "firebrick") +
stat_function(fun = dnorm, args = list(mean = 1.25, sd = 1), color = "green3") +
geom_vline(xintercept = 0, linetype = "longdash") +
theme_bw()
ggplot(data.frame(x = c(-4, 4)), aes(x)) +
stat_function(fun = dnorm, args = list(mean = -1.25, sd = 1),
color = "firebrick") +
stat_function(fun = dnorm, args = list(mean = 1.25, sd = 1), color = "green3") +
geom_vline(xintercept = 0, linetype = "longdash") +
theme_bw()
p4<-ggplot(data.frame(x = c(-4, 4)), aes(x)) +
stat_function(fun = dnorm, args = list(mean = -1.25, sd = 1),
color = "firebrick") +
stat_function(fun = dnorm, args = list(mean = 1.25, sd = 1), color = "green3") +
geom_vline(xintercept = 0, linetype = "longdash") +
theme_bw()
p5
set.seed(411)
library(ggplot2)
grupo_a <- rnorm(n = 30, mean = -1.25, sd = 1)
grupo_b <- rnorm(n = 30, mean = 1.25, sd = 1)
datos <- data.frame(valor = c(grupo_a, grupo_b),
grupo = rep(c("A","B"), each = 30))
p5<-ggplot(data = datos, aes(x = valor, fill = grupo)) +
geom_histogram(alpha = 0.5, position = "identity") +
geom_vline(xintercept = 0, linetype = "longdash") +
geom_vline(xintercept = (mean(grupo_a) + mean(grupo_b))/2)  +
annotate(geom = "text", x = 1.5, y = 9, label = "Límite decisión LDA") +
annotate(geom = "text", x = -1.5, y = 10, label = "Límite decisión Bayes") +
theme_bw() +
theme(legend.position = "top")
p5
p5
head(iris)
set.seed(411)
grupo_a <- rnorm(n = 30, mean = -1.25, sd = 1)
grupo_b <- rnorm(n = 30, mean = 1.25, sd = 1)
datos <- data.frame(valor = c(grupo_a, grupo_b),
grupo = rep(c("A","B"), each = 30))
p5<-ggplot(data = datos, aes(x = valor, fill = grupo)) +
geom_histogram(alpha = 0.5, position = "identity") +
geom_vline(xintercept = 0, linetype = "longdash") +
geom_vline(xintercept = (mean(grupo_a) + mean(grupo_b))/2)  +
annotate(geom = "text", x = 1.5, y = 9, label = "Límite decisión Bayes") +
annotate(geom = "text", x = -1.5, y = 10, label = "Límite decisión LDA") +
theme_bw() +
theme(legend.position = "top")
p5
p4
