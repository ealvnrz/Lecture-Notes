summary(logit_dummy)
summary(logit_dummy)
logit2 <- glm(default ~ balance + student + income, data = data,
family = "binomial")
summary(logit2)
summary(logit2)
p4<-ggplot(data.frame(x = c(-4, 4)), aes(x)) +
stat_function(fun = dnorm, args = list(mean = -1.25, sd = 1),
color = "firebrick") +
stat_function(fun = dnorm, args = list(mean = 1.25, sd = 1), color = "green3") +
geom_vline(xintercept = 0, linetype = "longdash") +
theme_bw()
p4
set.seed(411)
grupo_a <- rnorm(n = 30, mean = -1.25, sd = 1)
grupo_b <- rnorm(n = 30, mean = 1.25, sd = 1)
datos <- data.frame(valor = c(grupo_a, grupo_b),
grupo = rep(c("A","B"), each = 30))
p5<-ggplot(data = datos, aes(x = valor, fill = grupo)) +
geom_histogram(alpha = 0.5, position = "identity") +
geom_vline(xintercept = 0, linetype = "longdash") +
geom_vline(xintercept = (mean(grupo_a) + mean(grupo_b))/2)  +
annotate(geom = "text", x = 1.5, y = 9, label = "Límite decisión Bayes") +
annotate(geom = "text", x = -1.5, y = 10, label = "Límite decisión LDA") +
theme_bw() +
theme(legend.position = "top")
p5
library(MASS)
mod_lda <- lda(Species ~ Sepal.Width + Sepal.Length + Petal.Length +
Petal.Width, data = iris)
mod_lda
predicciones <- predict(object = mod_lda, newdata = iris[, -5])
table(iris$Species, predicciones$class, dnn = c("Clase real", "Clase predicha"))
library(klaR)
partimat(Species ~ Sepal.Width + Sepal.Length + Petal.Length + Petal.Width,
data = iris, method = "lda", prec = 200,
image.colors = c("darkgoldenrod1", "snow2", "skyblue2"),
col.mean = "firebrick")
names(Smarket)
head(Smarket)
cor(Smarket[,9])
cor(Smarket[,-9])
attach(Smarket)
plot(Volume)
attach(Smarket)
plot(Volume)
ggplot(data) +
aes(x = balance, colour = default) +
theme_gray()
esquisse:::esquisser()
attach(Smarket)
ggplot(Smarket) +
aes(x = Today, y = Volume) +
geom_point(shape = "circle", size = 1.5, colour = "#4682B4") +
theme_bw()
attach(Smarket)
ggplot(Smarket) +
aes(x = Today, y = Volume) +
geom_point(shape = "circle", size = 1.5, colour = "#4682B4") +
theme_bw()
esquisse:::esquisser()
plot(Volume)
autoplot(Volume)
autoplot(Smarket)
attach(Smarket)
ggplot(Smarket) +
aes(x = id, y = Volume) +
geom_point(shape = "circle", size = 1.5, colour = "#4682B4") +
theme_bw()
attach(Smarket)
ggplot(Smarket) +
aes(x = 1:1250, y = Volume) +
geom_point(shape = "circle", size = 1.5, colour = "#4682B4") +
theme_bw()
attach(Smarket)
ggplot(Smarket) +
aes(x = 1:nrow(Smarket), y = Volume) +
geom_point(shape = "circle", size = 1.5, colour = "#4682B4") +
theme_bw()
attach(Smarket)
p6<-ggplot(Smarket) +
aes(x = 1:nrow(Smarket), y = Volume) +
geom_point(shape = "circle", size = 1.5, colour = "#4682B4") +
theme_bw()
glm.fit=glm(Direction~Lag1+Lag2+Lag3+Lag4+Lag5+Volume,
data =Smarket , family = binomial )
glm.fit=glm(Direction~Lag1+Lag2+Lag3+Lag4+Lag5+Volume,
data= Smarket , family = binomial )
glm.fit=glm(Direction~Lag1+Lag2+Lag3+Lag4+Lag5+Volume,
data= Smarket , family = binomial )
summary(glm.fit)
glm.probs=predict(glm.fit,type="response")
glm.probs=predict(glm.fit,type="response")
glm.probs[1:10]
contrasts(Directions)
glm.probs=predict(glm.fit,type="response")
glm.probs[1:10]
contrasts(Direction)
glm.pred=rep("Down",1250)
glm.pred[glm.probs>.5]="Up"
glm.pred=rep("Down",1250)
glm.pred[glm.probs>.5]="Up"
table(glm.pred,Direction)
glm.pred=rep("Down",1250)
glm.pred[glm.probs>.5]="Up"
table(glm.pred,Direction)
(507+145)/1250
mean(glm.pred==Direction)
glm.pred=rep("Down",1250)
glm.pred[glm.probs>.5]="Up"
table(glm.pred,Direction)
(507+145)/1250
mean(glm.pred==Direction)
train =( Year <2005)
Smarket.2005=Smarket[!train,]
dim(Smarket.2005)
Direction.2005=Direction[!train]
glm.fit=glm(Direction~Lag1+Lag2+Lag3+Lag4+Lag5+Volume,
data =Smarket,family=binomial,subset=train)
glm.fit=glm(Direction~Lag1+Lag2+Lag3+Lag4+Lag5+Volume,
data =Smarket,family=binomial,subset=train)
glm.probs=predict(glm.fit,Smarket.2005,type="response")
glm.pred=rep("Down",252)
glm.pred[glm.probs >.5]="Up"
table(glm.pred, Direction.2005)
mean(glm.pred==Direction.2005)
mean(glm.pred!=Direction.2005)
glm.fit=glm(Direction~Lag1+Lag2,data=Smarket,family=binomial,
subset=train)
glm.probs=predict(glm.fit,Smarket.2005,type="response")
glm.pred=rep("Down",252)
glm.pred[glm.probs >.5]="Up"
table(glm.pred,Direction.2005)
predict(glm.fit,newdata=data.frame(Lag1=c(1.2,1.5),Lag2=c(1.1,-0.8)),
type="response")
lda.fit=lda(Direction~Lag1+Lag2,data=Smarket,subset=train)
lda.fit
plot(lda .fit )
lda.fit=lda(Direction~Lag1+Lag2,data=Smarket,subset=train)
lda.fit
plot(lda.fit)
lda.pred=predict(lda.fit,Smarket.2005)
names(lda.pred)
table(lda.class,Direction.2005)
lda.pred=predict(lda.fit,Smarket.2005)
names(lda.pred)
lda.class=lda.pred$class
table(lda.class,Direction.2005)
mean(lda.class==Direction.2005)
table(lda.class,Direction.2005)
mean(lda.class==Direction.2005)
sum(lda.pred$posterior[,1] >=.5)
sum(lda.pred$posterior[,1] <.5)
lda.pred$posterior[1:20,1]
lda . class [1:20]
lda.pred$posterior[1:20,1]
lda.class[1:20]
qda.fit=qda(Direction~Lag1+Lag2,data=Smarket,subset=train)
qda.fit
install.packages("class")
library(class)
train.X=cbind(Lag1,Lag2)[train,]
test.X=cbind(Lag1,Lag2)[!train,]
train.Direction=Direction[train]
knn.pred=knn(train.X,test.X,train.Direction,k=1)
table(knn.pred,Direction.2005)
(83+43) /252
knn.pred=knn(train.X,test.X,train.Direction,k=3)
table(knn.pred,Direction.2005)
mean(knn.pred==Direction.2005)
library(ISLR)
attach(Carseats)
High <- ifelse(Sales <= 8, "No", "Yes")
Carseats <- data.frame(Carseats, High)
tree.carseats <- tree(High ~ . - Sales, Carseats)
library(ISLR)
library(tree)
attach(Carseats)
High <- ifelse(Sales <= 8, "No", "Yes")
Carseats <- data.frame(Carseats, High)
tree.carseats <- tree(High ~ . - Sales, Carseats)
tree.carseats
summary(Carseats)
library(ISLR)
library(tree)
attach(Carseats)
High <- as.numeric(ifelse(Sales <= 8, "No", "Yes"))
Carseats <- data.frame(Carseats, High)
tree.carseats <- tree(High ~ . - Sales, Carseats)
Carseats
View(Carseats)
library(ISLR)
library(tree)
attach(Carseats)
High <- ifelse(Sales <= 8, "No", "Yes")
Carseats <- data.frame(Carseats, High)
tree.carseats <- tree(High ~ . - Sales, Carseats)
library(ISLR)
library(tree)
attach(Carseats)
High <- ifelse(Sales <= 8, "No", "Yes")
Carseats <- data.frame(Carseats, High)
tree.carseats <- tree(High ~ . - Sales, Carseats)
View(Carseats)
summary(Carseats)
class(High)
library(ISLR)
library(tree)
attach(Carseats)
High <- as.factor(ifelse(Sales <= 8, "No", "Yes"))
Carseats <- data.frame(Carseats, High)
tree.carseats <- tree(High ~ . - Sales, Carseats)
summary(Carseats)
tree.carseats
knitr::opts_chunk$set(cache=TRUE)
knitr::opts_chunk$set(fig.path='figs/')
knitr::opts_chunk$set(cache.path='cache/')
knitr::opts_chunk$set(
fig.process = function(x) {
x2 = sub('-\\d+([.][a-z]+)$', '\\1', x)
if (file.rename(x, x2)) x2 else x
}
)
library(tidyverse)
set.seed (411)
x=matrix(rnorm(200*2), ncol=2)
x[1:100,]=x[1:100,]+2
x[101:150,]=x[101:150,]-2
y=c(rep(1,150),rep(2,50))
dat=data.frame(x=x,y=as.factor(y))
ggplot(dat) +
aes(x = x, y = y, colour = default)
knitr::opts_chunk$set(cache=TRUE)
knitr::opts_chunk$set(fig.path='figs/')
knitr::opts_chunk$set(cache.path='cache/')
knitr::opts_chunk$set(
fig.process = function(x) {
x2 = sub('-\\d+([.][a-z]+)$', '\\1', x)
if (file.rename(x, x2)) x2 else x
}
)
library(tidyverse)
library(ISLR)
library(ggplot2)
library(gridExtra)
Advertising <- read.csv("./db/Advertising.csv")
head(Advertising)
p1<- ggplot(data = Advertising, mapping = aes(x = TV, y = Sales))+
geom_point() + geom_smooth(method = "lm", se = FALSE)
p2<- ggplot(data = Advertising, mapping = aes(x = Radio, y = Sales))+
geom_point() + geom_smooth(method = "lm", se = FALSE)
p3<- ggplot(data = Advertising, mapping = aes(x = Newspaper, y = Sales))+
geom_point() + geom_smooth(method = "lm", se = FALSE)
grid.arrange(p1, p2, p3, nrow = 1)
library(plot3D)
Income2<- read.csv("./db/Income2.csv")
# Ajuste
fit_2_3_loess <- loess(Income ~ Education + Seniority, data = Income2)
# Predicción de valores
x.pred <- seq(min(Income2$Education), max(Income2$Education), length.out = 30)
y.pred <- seq(min(Income2$Seniority), max(Income2$Seniority), length.out = 30)
xy     <- expand.grid(Education = x.pred, Seniority = y.pred)
z.pred <- matrix(predict(fit_2_3_loess, newdata = xy), nrow = 30, ncol = 30)
Income2 %>%
scatter3D(
type = "p",
x = Income2$Education,
y = Income2$Seniority,
z = Income2$Income,
colvar = NA, pch = 19, col = "gold", cex = 1.75,
phi = 25, theta = 45, expand = 0.6,
xlab = "Years of Education", ylab = "Seniority", zlab = "Income",
panel.first = scatter3D(x = Income2$Education,y = Income2$Seniority,
z = Income2$Income,colvar = NA, col = "black", add = T,
surf = list(x = x.pred, y = y.pred, z = z.pred,
fit = predict(fit_2_3_loess), facets = T, col = "skyblue",
border = "royalblue", alpha = 0.45)))
Income2 %>%
scatter3D(
type = "p",
x = Income2$Education,
y = Income2$Seniority,
z = Income2$Income,
colvar = NA, pch = 19, col = "gold", cex = 1.75,
phi = 25, theta = 45, expand = 0.6,
xlab = "Years of Education", ylab = "Seniority", zlab = "Income",
panel.first = scatter3D(x = Income2$Education,y = Income2$Seniority,
z = Income2$Income,colvar = NA, col = "black", add = T,
surf = list(x = x.pred, y = y.pred, z = z.pred,
fit = predict(fit_2_3_loess), facets = T, col = "skyblue", border = "royalblue", alpha = 0.45)))
data<-Default
head(data)
ggplot(data) +
aes(x = balance, y = income, colour = default) +
geom_point(shape = "bullet", size = 1.5) +
scale_color_hue(direction = -1) +
theme_gray()
ggplot(data) +
aes(x = balance, y = income, colour = default) +
geom_point(shape = "bullet", size = 1.5) +
scale_color_hue(direction = -1) +
theme_gray()
ggplot(data) +
aes(x = default, y = balance, fill = default) +
geom_boxplot(shape = "circle") +
scale_fill_hue(direction = -1) +
theme_gray()
ggplot(data) +
aes(x = default, y = income, fill = default) +
geom_boxplot(shape = "circle") +
scale_fill_hue(direction = -1) +
theme_gray()
logit <- glm(default ~ balance, data = data, family = "binomial")
summary(logit)
summary(logit)
logit_dummy<-glm(default ~ student, data = data, family = "binomial")
summary(logit_dummy)
summary(logit_dummy)
logit2 <- glm(default ~ balance + student + income, data = data,
family = "binomial")
summary(logit2)
summary(logit2)
p4<-ggplot(data.frame(x = c(-4, 4)), aes(x)) +
stat_function(fun = dnorm, args = list(mean = -1.25, sd = 1),
color = "firebrick") +
stat_function(fun = dnorm, args = list(mean = 1.25, sd = 1), color = "green3") +
geom_vline(xintercept = 0, linetype = "longdash") +
theme_bw()
p4
set.seed(411)
grupo_a <- rnorm(n = 30, mean = -1.25, sd = 1)
grupo_b <- rnorm(n = 30, mean = 1.25, sd = 1)
datos <- data.frame(valor = c(grupo_a, grupo_b),
grupo = rep(c("A","B"), each = 30))
p5<-ggplot(data = datos, aes(x = valor, fill = grupo)) +
geom_histogram(alpha = 0.5, position = "identity") +
geom_vline(xintercept = 0, linetype = "longdash") +
geom_vline(xintercept = (mean(grupo_a) + mean(grupo_b))/2)  +
annotate(geom = "text", x = 1.5, y = 9, label = "Límite decisión Bayes") +
annotate(geom = "text", x = -1.5, y = 10, label = "Límite decisión LDA") +
theme_bw() +
theme(legend.position = "top")
p5
library(MASS)
mod_lda <- lda(Species ~ Sepal.Width + Sepal.Length + Petal.Length +
Petal.Width, data = iris)
mod_lda
predicciones <- predict(object = mod_lda, newdata = iris[, -5])
table(iris$Species, predicciones$class, dnn = c("Clase real", "Clase predicha"))
library(klaR)
partimat(Species ~ Sepal.Width + Sepal.Length + Petal.Length + Petal.Width,
data = iris, method = "lda", prec = 200,
image.colors = c("darkgoldenrod1", "snow2", "skyblue2"),
col.mean = "firebrick")
names(Smarket)
dim(Smarket)
head(Smarket)
cor(Smarket[,-9])
attach(Smarket)
p6<-ggplot(Smarket) +
aes(x = 1:nrow(Smarket), y = Volume) +
geom_point(shape = "circle", size = 1.5, colour = "#4682B4") +
theme_bw()
p6
glm.fit=glm(Direction~Lag1+Lag2+Lag3+Lag4+Lag5+Volume,
data= Smarket , family = binomial )
summary(glm.fit)
glm.probs=predict(glm.fit,type="response")
glm.probs[1:10]
contrasts(Direction)
glm.pred=rep("Down",1250)
glm.pred[glm.probs>.5]="Up"
table(glm.pred,Direction)
(507+145)/1250
mean(glm.pred==Direction)
train=(Year <2005)
Smarket.2005=Smarket[!train,]
dim(Smarket.2005)
Direction.2005=Direction[!train]
glm.fit=glm(Direction~Lag1+Lag2+Lag3+Lag4+Lag5+Volume,
data =Smarket,family=binomial,subset=train)
glm.probs=predict(glm.fit,Smarket.2005,type="response")
glm.pred=rep("Down",252)
glm.pred[glm.probs >.5]="Up"
table(glm.pred, Direction.2005)
mean(glm.pred==Direction.2005)
mean(glm.pred!=Direction.2005)
glm.fit=glm(Direction~Lag1+Lag2,data=Smarket,family=binomial,
subset=train)
glm.probs=predict(glm.fit,Smarket.2005,type="response")
glm.pred=rep("Down",252)
glm.pred[glm.probs >.5]="Up"
table(glm.pred,Direction.2005)
mean(glm.pred==Direction.2005)
106/(106+76)
predict(glm.fit,newdata=data.frame(Lag1=c(1.2,1.5),Lag2=c(1.1,-0.8)),
type="response")
lda.fit=lda(Direction~Lag1+Lag2,data=Smarket,subset=train)
lda.fit
plot(lda.fit)
lda.pred=predict(lda.fit,Smarket.2005)
names(lda.pred)
lda.class=lda.pred$class
table(lda.class,Direction.2005)
mean(lda.class==Direction.2005)
sum(lda.pred$posterior[,1] >=.5)
sum(lda.pred$posterior[,1] <.5)
lda.pred$posterior[1:20,1]
lda.class[1:20]
sum(lda.pred$posterior[,1] >.9)
qda.fit=qda(Direction~Lag1+Lag2,data=Smarket,subset=train)
qda.fit
qda.class=predict(qda.fit,Smarket.2005)$class
table(qda.class,Direction.2005)
mean(qda.class==Direction.2005)
library(class)
train.X=cbind(Lag1,Lag2)[train,]
test.X=cbind(Lag1,Lag2)[!train,]
train.Direction=Direction[train]
knn.pred=knn(train.X,test.X,train.Direction,k=1)
table(knn.pred,Direction.2005)
(83+43)/252
knn.pred=knn(train.X,test.X,train.Direction,k=3)
table(knn.pred,Direction.2005)
mean(knn.pred==Direction.2005)
library(tree)
attach(Carseats)
require(ISLR)
head(Carseats)
High=as.factor(ifelse(Sales<=8,"No","Yes"))
Carseats=data.frame(Carseats,High)
Carseats_tree=tree(High~ . -Sales, data=Carseats)
summary(Carseats_tree)
plot(Carseats_tree)
text(Carseats_tree, pretty=0)
#Alternativa
library(rpart)
library(rpart.plot)
Carseats_tree2<-rpart(formula=High~ . -Sales, data=Carseats)
tree_plot<-rpart.plot(Carseats_tree2)
train=sample(1:nrow(Carseats), 200)
Carseats_test=Carseats[-train,]
High_test=High[-train]
Carseats_tree=tree(High~ .-Sales ,Carseats ,subset = train)
tree_pred=predict(Carseats_tree ,Carseats_test , type ="class")
table(tree_pred,High_test)
(92+65)/200
library(e1071)
library(ggplot2)
set.seed(411)
coord <- matrix(rnorm(40), 20, 2)
colnames(coord) <- c("X1","X2")
y <- c(rep(-1,10), rep(1,10))
coord[y == 1, ] <- coord[y == 1, ] + 1
data <- data.frame(coord, y)
plot_svm<-ggplot(data = data, aes(x = X1, y = X2, color = as.factor(y))) +
geom_point(size = 6) +
theme_bw() +
theme(legend.position = "none")
data$y <- as.factor(data$y)
mod_svm <- svm(formula = y ~ X1 + X2, data = data, kernel = "linear",
cost = 10, scale = FALSE)
summary(mod_svm)
mod_svm$index
plot(mod_svm, data)
set.seed (411)
x=matrix(rnorm(200*2), ncol=2)
x[1:100,]=x[1:100,]+2
x[101:150,]=x[101:150,]-2
y=c(rep(1,150),rep(2,50))
dat=data.frame(x=x,y=as.factor(y))
ggplot(dat) +
aes(x = x, y = y)
ggplot(dat) +
aes(x = x, y = y) + theme_gray()
ggplot(dat)
esquisse:::esquisser()
train=sample(200,100)
svmfit=svm(y~., data=dat[train,], kernel="radial", gamma=1,cost =1)
plot(svmfit , dat[train ,])
table(true=dat[-train,"y"], pred=predict(svmfit, newdata=dat[-train ,]))
ggplot(dat) +
aes(x = x.1, y = x.2, colour = y) +
geom_point(shape = "circle", size = 1.5) +
scale_color_hue(direction = 1) +
theme_bw()
plot_radial<-ggplot(dat) +
aes(x = x.1, y = x.2, colour = y) +
geom_point(shape = "circle", size = 1.5) +
scale_color_hue(direction = 1) +
theme_bw()
plot_radial<-ggplot(dat) +
aes(x = x.1, y = x.2, colour = y) +
geom_point(shape = "circle", size = 1.5) +
scale_color_hue(direction = 1) +
theme_bw()
data("USArrests")
knitr::opts_chunk$set(cache=TRUE)
knitr::opts_chunk$set(fig.path='figs/')
knitr::opts_chunk$set(cache.path='cache/')
knitr::opts_chunk$set(
fig.process = function(x) {
x2 = sub('-\\d+([.][a-z]+)$', '\\1', x)
if (file.rename(x, x2)) x2 else x
}
)
library(tidyverse)
data("USArrests")
head(USArrests)
data("USArrests")
head(USArrests)
gc()
